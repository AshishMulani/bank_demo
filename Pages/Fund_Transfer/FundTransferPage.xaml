<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:bank_demo.ViewModels.FeaturesPages.FundTransfer"
             x:Class="bank_demo.Pages.Fund_Transfer.FundTransferPage"
             Title="Fund Transfer"
             BackgroundColor="#f2f2f7">

    <ContentPage.BindingContext>
        <vm:FundTransferViewModel/>
    </ContentPage.BindingContext>

    <VerticalStackLayout Padding="20" Spacing="20">

        <!-- Tab Switch -->
        <Frame BackgroundColor="White" CornerRadius="30" Padding="6" HasShadow="False" HeightRequest="60">
            <Grid ColumnDefinitions="*,*">
                <Button Grid.Column="0" Text="Beneficiary List"
                        Command="{Binding ShowListCommand}"
                        BackgroundColor="{Binding IsListVisible, Converter={StaticResource BoolToTabColorConverter}}"
                        TextColor="{Binding IsListVisible, Converter={StaticResource BoolToTabTextColorConverter}}"
                        CornerRadius="25" Margin="0,0,4,0"/>

                <Button Grid.Column="1" Text="Add Beneficiary"
                        Command="{Binding ShowAddFormCommand}"
                        BackgroundColor="{Binding IsAddVisible, Converter={StaticResource BoolToTabColorConverter}}"
                        TextColor="{Binding IsAddVisible, Converter={StaticResource BoolToTabTextColorConverter}}"
                        CornerRadius="25" Margin="4,0,0,0"/>
            </Grid>
        </Frame>

        <!-- Beneficiary List -->
        <ContentView IsVisible="{Binding IsListVisible}">
            <CollectionView ItemsSource="{Binding Beneficiaries}"
                            SelectionMode="Single"
                            SelectionChanged="OnBeneficiarySelected"  
                Margin="0,10,0,0">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BackgroundColor="White" CornerRadius="15" Padding="10" Margin="5">
                            <Grid ColumnDefinitions="2*,1*">
                                <VerticalStackLayout>
                                    <Label Text="{Binding Name}" FontAttributes="Bold" FontSize="16" />
                                    <Label Text="{Binding Description}" FontSize="12" TextColor="Gray" />
                                </VerticalStackLayout>
                                <Label Text="â‚¹30" FontAttributes="Bold" TextColor="Blue"
                                       VerticalOptions="Center" HorizontalOptions="End" />
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </ContentView>

        <!-- Add Beneficiary Form -->
        <ContentView IsVisible="{Binding IsAddVisible}">
            <VerticalStackLayout Spacing="10">
                <Entry Placeholder="Savings Account" Text="{Binding AccountType}" />
                <Entry Placeholder="Account Number" Text="{Binding AccountNumber}" />
                <Entry Placeholder="Office Name" Text="{Binding OfficeName}" />
                <Entry Placeholder="Transfer Limit" Text="{Binding TransferLimit}" />
                <Entry Placeholder="Beneficiary Name" Text="{Binding BeneficiaryName}" />
                <Button Text="Submit Beneficiary"
                        Command="{Binding SubmitCommand}"
                        BackgroundColor="Blue" TextColor="White" CornerRadius="25"/>
            </VerticalStackLayout>
        </ContentView>

    </VerticalStackLayout>
</ContentPage>
