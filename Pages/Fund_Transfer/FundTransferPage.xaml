<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:bank_demo.ViewModels.FeaturesPages.FundTransfer"
             x:Class="bank_demo.Pages.Fund_Transfer.FundTransferPage"
             x:Name="RootPage"
             Title="Fund Transfer">

    <ContentPage.BindingContext>
        <vm:FundTransferViewModel/>
    </ContentPage.BindingContext>

    <VerticalStackLayout Padding="20" Spacing="20">

        <!-- Tab Switch -->
        <Frame BackgroundColor="White" CornerRadius="30" Padding="6" HasShadow="False" HeightRequest="60">
            <Grid ColumnDefinitions="*,*">
                <Button Grid.Column="0" Text="Beneficiary List"
                        Command="{Binding ShowListCommand}"
                        CornerRadius="25" Margin="0,0,4,0"/>
                <Button Grid.Column="1" Text="Add Beneficiary"
                        Command="{Binding ShowAddFormCommand}"
                        CornerRadius="25" Margin="4,0,0,0"/>
            </Grid>
        </Frame>

        <!-- Beneficiary List -->
        <ContentView IsVisible="{Binding IsListVisible}">
            <CollectionView ItemsSource="{Binding Beneficiaries}"
                            Margin="0,10,0,0">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border BackgroundColor="White"
                                Stroke="LightGray"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 15"
                                Margin="5"
                                Padding="10">

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding BindingContext.BeneficiaryTappedCommand, Source={x:Reference RootPage}}"
                                                      CommandParameter="{Binding .}" />
                            </Border.GestureRecognizers>

                            <Grid ColumnDefinitions="2*,1*">
                                <VerticalStackLayout>
                                    <Label Text="{Binding Name}" FontAttributes="Bold" FontSize="16" />
                                    <Label Text="{Binding Description}" FontSize="12" TextColor="Gray" />
                                </VerticalStackLayout>
                                
                            </Grid>

                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </ContentView>

        <!-- Add Beneficiary Form -->
        <ContentView IsVisible="{Binding IsAddVisible}">
            <VerticalStackLayout Spacing="10">
                <Entry Placeholder="Savings Account" Text="{Binding AccountType}" />
                <Entry Placeholder="Account Number" Text="{Binding AccountNumber}"/>
                <Entry Placeholder="Office Name" Text="{Binding OfficeName}" />
                <Entry Placeholder="Transfer Limit" Text="{Binding TransferLimit}" />
                <Entry Placeholder="Beneficiary Name" Text="{Binding BeneficiaryName}" />
                <Button Text="Submit Beneficiary"
                        Command="{Binding SubmitCommand}"
                        BackgroundColor="Blue" TextColor="White" CornerRadius="25"/>
            </VerticalStackLayout>
        </ContentView>

    </VerticalStackLayout>
</ContentPage>
